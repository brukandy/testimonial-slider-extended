const testimonials = {
    fabio: {
        name: "Fabio",
        role: "Imprenditore e Franchise Owner",
        highlight: "Da 250.000 € a DECINE di milioni di euro di fatturato annuo",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/f3lBU52wDPQ",
        thumbnailUrl: "images/fabio-testimonial.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Fatturava circa 250.000 € all'anno con un modello tradizionale e una struttura poco scalabile."
            },
            {
                label: "Intervento",
                text: "Applica le strategie di business, leadership e gestione aziendale apprese nei programmi di affiancamento."
            },
            {
                label: "Risultato misurabile",
                text: "Oggi supera di gran lunga <strong>DECINE di milioni di euro</strong> di fatturato annuo, espandendo la rete commerciale e creando un sistema di crescita stabile e replicabile."
            },
            {
                label: "Tempo/Impegno",
                text: "Tre anni di applicazione costante e mentoring continuativo."
            }
        ]
    },
    gilberto: {
        name: "Gilberto",
        role: "Imprenditore nel settore servizi",
        highlight: "Incremento del 150% in 12 mesi: da 600.000 € a 1,5 milioni",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/pmbVLQppfgc",
        thumbnailUrl: "images/gilberto-tetimonial.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Azienda in difficoltà economica, fatturato fermo a 600.000 € l'anno e un team di venti persone."
            },
            {
                label: "Intervento",
                text: "Partecipa ai programmi di affiancamento dedicati a imprenditori, lavorando su leadership, gestione del team e controllo operativo."
            },
            {
                label: "Risultato misurabile",
                text: "Incrementa il fatturato del <strong>150% in un anno</strong>, passando da 600.000 € a 1,5 milioni, e porta il team da 20 a 55 collaboratori. Oggi guida un'impresa solida, in crescita costante."
            },
            {
                label: "Tempo/Impegno",
                text: "Tutto questo in soli dodici mesi di affiancamento con applicazione settimanale delle strategie apprese."
            }
        ]
    },
    sandra: {
        name: "Sandra",
        role: "Primo investimento immobiliare",
        highlight: "ROI del 30,64% - €64.000 di guadagno netto",
        mediaType: "photo",
        mediaUrl: "images/sandra-testimonial.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Nessuna esperienza nel settore immobiliare, solo il desiderio di entrare nel mercato con una preparazione solida."
            },
            {
                label: "Intervento",
                text: "Partecipa al REM (Real Estate Master), frequenta i 3 moduli strutturati e i workshop pratici per consolidare le conoscenze e acquisire fiducia operativa."
            },
            {
                label: "Risultato misurabile",
                text: "Prima ancora di completare il programma, chiude la sua prima operazione immobiliare con un <strong>ROI del 30,64%</strong>, generando €64.000 di guadagno netto."
            },
            {
                label: "Tempo/Impegno",
                text: "Prima operazione conclusa prima della fine del Programma formativo, applicando immediatamente le strategie apprese."
            }
        ]
    },
    alice: {
        name: "Alice",
        role: "Interior Designer",
        highlight: "Da 1.100 € al mese a designer per Hilton London",
        mediaType: "photo",
        mediaUrl: "images/alice-testimonial.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Guadagnava 1.100 € al mese come freelance a Milano, in una fase di blocco personale e professionale."
            },
            {
                label: "Intervento",
                text: "Segue il programma di affiancamento Master in Evoluzione Personale, lavorando su fiducia, chiarezza e capacità decisionale."
            },
            {
                label: "Risultato misurabile",
                text: "Ottiene un incarico per curare il design di un <strong>hotel Hilton a Londra</strong> e si trasferisce all'estero, costruendo una nuova carriera internazionale."
            },
            {
                label: "Tempo/Impegno",
                text: "Tutto questo in soli dodici mesi di Programma e applicazione costante."
            }
        ]
    },
    roberto: {
        name: "Roberto",
        role: "Settore turistico – Provincia di Bolzano",
        highlight: "2 aggiudicazioni immobiliari in 6 mesi",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/x4mnP3TWMQk",
        thumbnailUrl: "images/roberto.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Roberto lavora nel settore turistico e negli affitti brevi. Pur non provenendo dal mondo immobiliare, decide di intraprendere il percorso REM con l'obiettivo di aggiudicarsi i suoi primi immobili all'asta."
            },
            {
                label: "Intervento",
                text: "Segue il programma con costanza per sei mesi, applicando la perseveranza e le strategie consigliate dai docenti. Studia il mercato, partecipa alle aste e mette in pratica ciò che apprende lezione dopo lezione."
            },
            {
                label: "Risultato misurabile",
                text: "Ottiene due risultati importanti in pochissimo tempo: <strong>Aprile: aggiudicazione di un garage (ROI stimato intorno al 28%)</strong>. <strong>17 giugno: aggiudicazione di un appartamento all'offerta minima, essendo l'unico partecipante (ROI previsto circa 38%)</strong>. Due operazioni immobiliari portate a casa in sei mesi, entrambe con ottime prospettive di rendimento."
            },
            {
                label: "Tempo/Impegno",
                text: "Il garage è stato saldato una settimana fa, mentre l'appartamento verrà saldato nei prossimi mesi per poi completare la rivendita nella primavera del prossimo anno."
            }
        ]
    },
    chiara: {
        name: "Chiara",
        role: "Architetto – Verona",
        highlight: "Da zero competenze a piena consapevolezza del proprio mercato",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/-3SXCseesAc",
        thumbnailUrl: "images/chiara-vesani.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Partiva da zero competenze di marketing e cercava maggiore consapevolezza per individuare la nicchia professionale in cui posizionarsi come architetto."
            },
            {
                label: "Intervento",
                text: "Intraprende il Master con dedizione, partecipando attivamente alle lezioni e ai canali della community. Si confronta regolarmente con i docenti e con gli altri studenti, trasformando il percorso in un vero lavoro di squadra."
            },
            {
                label: "Risultato misurabile",
                text: "Acquisisce chiarezza sulla propria direzione professionale e sviluppa una nuova consapevolezza sul mercato a cui rivolgersi. Si sente finalmente sulla strada giusta per raggiungere i suoi obiettivi."
            },
            {
                label: "Tempo/Impegno",
                text: "Il percorso è impegnativo ma arricchente. Sin dalle prime settimane percepisce miglioramenti concreti nelle sue competenze e nella visione strategica del suo futuro."
            }
        ]
    },
    armando: {
        name: "Armando",
        role: "Docente di Digital Marketing e Imprenditore",
        highlight: "+100% fatturato in 4 mesi",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/N6dfrNPpUP4",
        thumbnailUrl: "images/armando-giorgi.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Docente di digital marketing e imprenditore, sentiva il bisogno di un percorso che potesse far emergere meglio le sue competenze e tradurle in risultati concreti, sia personali che professionali."
            },
            {
                label: "Intervento",
                text: "Inizia dal MEP e prosegue con altri percorsi, lavorando su mindset, leadership e trasformazione delle azioni quotidiane. Trova subito sintonia con l'ecosistema della scuola e con gli altri professionisti."
            },
            {
                label: "Risultato misurabile",
                text: "Nei primi quattro mesi vive una vera epifania: <strong>raddoppia il fatturato</strong> e ottiene miglioramenti tangibili nella gestione del lavoro e nella crescita personale."
            },
            {
                label: "Tempo/Impegno",
                text: "Risultati visibili già nelle prime settimane, consolidati nell'arco di quattro mesi applicando con costanza le strategie apprese."
            }
        ]
    },
    salvatore: {
        name: "Salvatore",
        role: "Direttore Tecnico Amministrativo – Grey Chemica All Srl",
        highlight: "Diventa azienda leader del settore in Europa",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/bHgNNyFFi-Q",
        thumbnailUrl: "images/salvatore-sgobbio.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Salvatore, direttore tecnico amministrativo in un'azienda chimica, riconosce quanto sarebbe stato diverso il suo percorso imprenditoriale se avesse avuto sin dall'inizio le informazioni corrette per prendere decisioni strategiche efficaci."
            },
            {
                label: "Intervento",
                text: "Partecipa ai programmi della Leone Master School e all'evento 'Io Creo il Mio Destino'. Trova un percorso strutturato che lo aiuta a migliorare la visione imprenditoriale, la gestione aziendale e la capacità di individuare ciò che davvero fa la differenza nel far crescere un'impresa."
            },
            {
                label: "Risultato misurabile",
                text: "Grazie alle informazioni acquisite nei programmi, applica nuove strategie che permettono all'azienda di <strong>posizionarsi come leader del settore in Europa</strong>. Definisce queste informazioni come vincenti, un reale punto di svolta per il suo modo di fare business."
            },
            {
                label: "Tempo/Impegno",
                text: "Applica costantemente ciò che apprende e sottolinea che, con queste informazioni, avrebbe fatto un decimo della fatica nel suo cammino imprenditoriale."
            }
        ]
    },
    gianluca: {
        name: "Gianluca",
        role: "Settore edilizio – Pisa",
        highlight: "Team da 3 a 6 collaboratori e aumento del guadagno personale",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/QV_VD7X4nU4",
        thumbnailUrl: "images/gianluca.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Gianluca lavora nel settore edilizio e sentiva la necessità di migliorare la gestione del denaro, sia personale che aziendale. Aveva bisogno di strategie pratiche per aumentare la liquidità e far crescere la sua attività."
            },
            {
                label: "Intervento",
                text: "Partecipa ai programmi della Leone Master School, dove apprende nuove strategie finanziarie e gestionali che applica immediatamente nel suo settore. Integra le informazioni ricevute nel suo lavoro quotidiano, migliorando processi, gestione economica e acquisizione clienti."
            },
            {
                label: "Risultato misurabile",
                text: "I risultati arrivano rapidamente: ottiene molti più contratti, grazie al nuovo approccio. Incrementa il suo guadagno personale. <strong>Fa crescere la sua azienda: da un team di 3 persone del nucleo familiare a 6 collaboratori totali</strong>, assumendo 3 nuove risorse. Gianluca definisce questo risultato un notevole successo sia a livello economico che professionale."
            },
            {
                label: "Tempo/Impegno",
                text: "Applica con costanza le strategie imparate, integrandole nella gestione quotidiana dell'azienda e ottenendo benefici tangibili nel breve periodo."
            }
        ]
    },
    regina: {
        name: "Regina",
        role: "Settore servizi",
        highlight: "Fatturato 5X grazie ai sistemi di marketing",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/41PsEZWOMJU",
        thumbnailUrl: "images/regina.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Regina aveva entrate mensili molto basse, tra 1.000 e 1.500 € lordi, che non le permettevano di avere stabilità economica. Sentiva il bisogno di strumenti di marketing e di negoziazione per far crescere la sua attività."
            },
            {
                label: "Intervento",
                text: "Partecipa ai programmi della Leone Master School, dove acquisisce informazioni fondamentali sulla pianificazione di marketing, sulla gestione del posizionamento e sulle strategie di negoziazione — proprio l'area che identificava come suo punto debole."
            },
            {
                label: "Risultato misurabile",
                text: "I risultati sono sorprendenti: <strong>il fatturato si quintuplica</strong>. Ottiene maggiore controllo della sua attività grazie ai sistemi di marketing appresi. Aumenta la sicurezza nella negoziazione e nella gestione dei clienti. Regina definisce questi risultati molto importanti, frutto dell'applicazione costante delle informazioni ricevute."
            },
            {
                label: "Tempo/Impegno",
                text: "Integra progressivamente le nuove strategie nella sua attività quotidiana, ottenendo miglioramenti tangibili in pochi mesi."
            }
        ]
    },
    jessica: {
        name: "Jessica",
        role: "Aspirante Coach Professionista",
        highlight: "Più sicurezza e nuove opportunità lavorative",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/iVtTW-tP6O4",
        thumbnailUrl: "images/jessica.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Jessica vuole crescere come coach professionista e sente il bisogno di un percorso che le dia maggiore sicurezza, competenze solide e nuove opportunità nel mondo del coaching."
            },
            {
                label: "Intervento",
                text: "Inizia il Master per sviluppare strumenti pratici, una visione più chiara del suo ruolo e la consapevolezza di ciò che può portare agli altri. Il percorso le permette di lavorare in profondità su sé stessa e sulle sue capacità di supporto e guida."
            },
            {
                label: "Risultato misurabile",
                text: "Acquisisce maggiore sicurezza nelle proprie abilità e nella direzione professionale che vuole intraprendere. Si sente più preparata, più consapevole e con prospettive lavorative reali e concrete nel coaching."
            },
            {
                label: "Tempo/Impegno",
                text: "Affronta il percorso in modo intenzionale, seguendo quello che sente davvero dentro. Consiglia il Master a chi desidera seriamente diventare coach e intraprendere un percorso trasformativo, personale e professionale."
            }
        ]
    },
    carmela: {
        name: "Carmela",
        role: "Insegnante di matematica – Mamma di 3 figli",
        highlight: "Dimagrire e alzare l'autostima",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/PUbLRY1xzwI",
        thumbnailUrl: "images/carmela-bondonno.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Carmela, insegnante di matematica e mamma di tre figli, stava attraversando un periodo complesso sia economicamente che emotivamente. Proveniva da un matrimonio difficile che aveva compromesso profondamente la sua autostima."
            },
            {
                label: "Intervento",
                text: "Inizia i programmi della Leone Master School con l'obiettivo di rimettersi in forma, recuperare equilibrio e affrontare il momento delicato nel modo migliore possibile. Durante il percorso scopre nuove opportunità, nuove prospettive e una forza personale che non sapeva di avere."
            },
            {
                label: "Risultato misurabile",
                text: "<strong>Sta dimagrendo e migliorando la sua condizione fisica</strong>. Recupera autostima, energia e serenità. Riconosce di avere una forte predisposizione nell'aiutare gli altri e comprende di voler diventare mental coach, trasformando il suo percorso personale in una nuova opportunità professionale."
            },
            {
                label: "Tempo/Impegno",
                text: "Affronta il programma con costanza, mantenendo l'impegno nonostante le difficoltà. I risultati emotivi e fisici arrivano progressivamente, restituendole fiducia e direzione."
            }
        ]
    },
    ivan: {
        name: "Ivan",
        role: "Imprenditore multiservizi – Cosenza",
        highlight: "Migliorare l'organizzazione aziendale",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/dqQs-a3Hxkc",
        thumbnailUrl: "images/ivan-pittelli.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Ivan, 40 anni, imprenditore di un'azienda multiservizi specializzata in comparazione di utenze e efficienza energetica, sentiva la necessità di fare un vero salto di qualità nella gestione della sua attività. L'organizzazione interna non era ottimizzata e spesso si ritrovava a fare tutto da solo."
            },
            {
                label: "Intervento",
                text: "Entra nei programmi della Leone Master School per apprendere un metodo chiaro, pratico e applicabile alla gestione aziendale. Durante il percorso comprende di aver finalmente trovato la scuola giusta, grazie a contenuti che definisce la ciliegina sulla torta. Lavora soprattutto su: organizzazione dell'azienda, gestione delle risorse, strutturazione dei processi."
            },
            {
                label: "Risultato misurabile",
                text: "Ivan vive una trasformazione significativa: <strong>impara a organizzare l'azienda</strong>, cosa che prima non riusciva a fare con continuità. Migliora la gestione dei processi interni. Acquisisce una mentalità più orientata all'azione e alla crescita. Riconosce che rimandare questo percorso significherebbe perdere tempo, soldi ed energie."
            },
            {
                label: "Tempo/Impegno",
                text: "Applica giorno dopo giorno ciò che apprende, ottenendo un miglioramento concreto nell'organizzazione aziendale e una maggiore chiarezza nel ruolo imprenditoriale."
            }
        ]
    },
    "maria-grazia": {
        name: "Maria Grazia",
        role: "Consulente in sostenibilità – Italia / Spagna",
        highlight: "Migliora le collaborazioni internazionali",
        mediaType: "video",
        mediaUrl: "https://www.youtube.com/embed/G_G98bKwLa8",
        thumbnailUrl: "images/maria-grazia-di-filippo.png",
        sections: [
            {
                label: "Situazione di partenza",
                text: "Maria Grazia, 48 anni, lavora da sempre nel settore della sostenibilità e dell'auditing con collaborazioni tra Spagna e Italia. Cercava un percorso che potenziasse ulteriormente le sue competenze, migliorasse la sua operatività internazionale e le permettesse di avere un affiancamento costante da professionisti esperti."
            },
            {
                label: "Intervento",
                text: "Decide di entrare nei programmi della Leone Master School dopo una chiamata chiarificatrice con Nora, che le indica il percorso più adatto ai suoi obiettivi. Nel Master ABM trova: tecniche pratiche immediatamente applicabili, affiancamento da docenti esperti, flessibilità nella formazione online, un supporto continuo per crescere con costanza."
            },
            {
                label: "Risultato misurabile",
                text: "Dopo quasi un anno all'interno della scuola, ottiene miglioramenti significativi: <strong>potenzia le sue collaborazioni internazionali tra Italia e Spagna</strong>. Acquisisce maggiore consapevolezza professionale e personale. Impara a trarre valore anche dai fallimenti. Cresce quotidianamente grazie al confronto con professionisti che hanno già realizzato percorsi simili."
            },
            {
                label: "Tempo/Impegno",
                text: "Lavora con costanza, perseveranza e obiettivi chiari. La trasformazione è progressiva ma solida, sostenuta dall'affiancamento diretto dei docenti."
            }
        ]
    }
};

const modalOverlay = document.getElementById('modalOverlay');
const modalContent = document.getElementById('modalContent');
const modalClose = document.getElementById('modalClose');
const cards = document.querySelectorAll('.testimonial-card');
const cardsGrid = document.querySelector('.cards-grid');
const mobileDots = document.querySelectorAll('.mobile-dot');

document.addEventListener('DOMContentLoaded', function() {
    cards.forEach(card => {
        card.addEventListener('click', function() {
            const testimonialId = this.getAttribute('data-testimonial');
            openModal(testimonialId);
        });
    });

    modalClose.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', function(e) {
        if (e.target === modalOverlay) {
            closeModal();
        }
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modalOverlay.classList.contains('active')) {
            closeModal();
        }
    });

    // Mobile slider dots update
    if (cardsGrid && mobileDots.length > 0) {
        cardsGrid.addEventListener('scroll', updateMobileDots);
        updateMobileDots(); // Initial update
    }
});

function updateMobileDots() {
    const scrollLeft = cardsGrid.scrollLeft;
    const cardWidth = cards[0].offsetWidth;
    const gap = 16; // Same as CSS gap
    const activeIndex = Math.round(scrollLeft / (cardWidth + gap));
    
    mobileDots.forEach((dot, index) => {
        if (index === activeIndex) {
            dot.classList.add('active');
        } else {
            dot.classList.remove('active');
        }
    });
}

// Store scroll position for iOS
let scrollPosition = 0;

function openModal(testimonialId) {
    const data = testimonials[testimonialId];
    if (!data) return;

    // Lock body scroll and save position
    scrollPosition = window.pageYOffset;
    document.body.style.overflow = 'hidden';
    document.body.style.position = 'fixed';
    document.body.style.top = `-${scrollPosition}px`;
    document.body.style.width = '100%';

    let mediaHTML = '';
    if (data.mediaType === 'video') {
        if (data.mediaUrl) {
            // Check if it's a YouTube URL
            if (data.mediaUrl.includes('youtube.com') || data.mediaUrl.includes('youtu.be')) {
                mediaHTML = `<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 16px;">
                    <iframe 
                        src="${data.mediaUrl}" 
                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 16px;"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>`;
            } else {
                // Regular video file
                mediaHTML = `<video controls style="width: 100%; border-radius: 16px;">
                    <source src="${data.mediaUrl}" type="video/mp4">
                </video>`;
            }
        } else {
            mediaHTML = `<div class="modal-media-placeholder">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                    <circle cx="40" cy="40" r="40" fill="rgba(255,255,255,0.15)"/>
                    <path d="M32 26L54 40L32 54V26Z" fill="white"/>
                </svg>
            </div>`;
        }
    } else {
        if (data.mediaUrl) {
            mediaHTML = `<img src="${data.mediaUrl}" alt="${data.name}" style="width: 100%; border-radius: 16px;">`;
        } else {
            mediaHTML = `<div class="modal-media-placeholder">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                    <circle cx="40" cy="40" r="40" fill="rgba(255,255,255,0.15)"/>
                    <path d="M40 25C33.373 25 28 30.373 28 37C28 43.627 33.373 49 40 49C46.627 49 52 43.627 52 37C52 30.373 46.627 25 40 25ZM40 31C42.071 31 43.75 32.679 43.75 34.75C43.75 36.821 42.071 38.5 40 38.5C37.929 38.5 36.25 36.821 36.25 34.75C36.25 32.679 37.929 31 40 31ZM40 46C36.625 46 33.625 44.313 31.75 41.688C31.788 39 37 37.563 40 37.563C42.963 37.563 48.213 39 48.25 41.688C46.375 44.313 43.375 46 40 46Z" fill="white"/>
                </svg>
            </div>`;
        }
    }

    let sectionsHTML = '';
    data.sections.forEach(section => {
        sectionsHTML += `
            <div class="modal-section">
                <div class="modal-section-label">${section.label}</div>
                <div class="modal-section-text">${section.text}</div>
            </div>
        `;
    });

    modalContent.innerHTML = `
        <div class="modal-header">
            <div class="modal-media">
                ${mediaHTML}
            </div>
            <div class="modal-info">
                <h2 class="modal-name">${data.name}</h2>
                <p class="modal-role">${data.role}</p>
                <div class="modal-highlight">
                    <div class="modal-highlight-text">${data.highlight}</div>
                </div>
            </div>
        </div>
        <div class="modal-sections">
            ${sectionsHTML}
        </div>
    `;

    modalOverlay.classList.add('active');
}

function closeModal() {
    modalOverlay.classList.remove('active');
    
    // Restore body scroll and position
    document.body.style.overflow = '';
    document.body.style.position = '';
    document.body.style.top = '';
    document.body.style.width = '';
    window.scrollTo(0, scrollPosition);
}
